package extensions

import (
	"encoding/json"

	"github.com/blackcrw/wprecon/pkg/printer"
)

type Jsonformat struct {
	ID struct {
	} `json:"_id"`
	Vulnerabilities []struct {
		Title      string   `json:"Title"`
		Published  string   `json:"Published"`
		References []string `json:"References"`
		Version    string   `json:"Version"`
	} `json:"Vulnerabilities"`
}

func GetVuln(plugin string, version string) *Jsonformat {
	var jsonn Jsonformat

	response := SimpleRequest("http://144.217.235.104:8777", "/v1/api/vulnerable/plugins/"+plugin+"/"+version)

	printer.Println(response.Raw)

	err := json.Unmarshal([]byte(response.Raw), &jsonn)

	if err != nil {
		printer.Println(err)
	}

	return &jsonn
}
